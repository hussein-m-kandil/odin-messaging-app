@let _narrowScreen = vpWidth() < 720; @let _singularViewEnabled = singularViewEnabled();

<!-- prettier-ignore -->
@if (!_narrowScreen) {
<div
  [class]="`absolute left-1 bottom-1 z-30 transition-all duration-300
    opacity-50 hover:opacity-100 scale-25 hover:scale-100
   focus-within:opacity-100 focus-within:scale-100
  `"
>
  @let _viewSwitchLabel = _singularViewEnabled ? 'Open main menu' : 'Close main menu';
  <button
    pButton
    pRipple
    rounded
    size="small"
    type="button"
    (click)="toggleSingularView()"
    aria-label="{{ _viewSwitchLabel }}"
    icon="{{ _singularViewEnabled ? 'pi pi-tablet' : 'pi pi-th-large' }}"
  ></button>
</div>
}
<!-- prettier-ignore -->

@if(_narrowScreen || _singularViewEnabled) {
<ng-container [ngTemplateOutlet]="_singularView" />
} @else {
<ng-container [ngTemplateOutlet]="_compoundView" />
}

<ng-template #_singularView>
  @if (navListRouteActivated()) {
  <ng-container [ngTemplateOutlet]="_menu" />
  } @else {
  <router-outlet />
  }
</ng-template>

<ng-template #_compoundView>
  <div class="absolute top-0 left-0 w-82 h-full overflow-auto border-surface border-r">
    <ng-container [ngTemplateOutlet]="_menu" />
  </div>
  <div class="absolute top-0 left-82 right-0 h-full overflow-auto">
    <router-outlet />
  </div>
</ng-template>

<ng-template #_menu>
  <nav class="absolute size-full overflow-auto">
    <p-tabs [value]="activeNavItemIndex()">
      <p-tablist [pt]="{ content: { class: `*:h-10 *:border-0` } }">
        @for(_navItem of navItems; track _navItem){
        <p-tab [value]="$index" class="inline-block relative w-1/2 h-full p-0">
          <a
            ariaCurrentWhenActive="page"
            routerLinkActive="p-tab-active"
            [routerLink]="[_navItem.route]"
            [routerLinkActiveOptions]="{ exact: true }"
            class="inline-block relative size-full text-center leading-tight *:align-middle"
          >
            <span class="absolute top-1/2 left-1/2 -translate-1/2">
              <i [class]="_navItem.icon"></i>&nbsp;{{ _navItem.label }}
            </span>
          </a>
        </p-tab>
        }
      </p-tablist>
    </p-tabs>
    <div [class]="`absolute top-10 left-0 bottom-0 w-full overflow-auto`">
      <router-outlet name="menu" />
    </div>
  </nav>
</ng-template>
