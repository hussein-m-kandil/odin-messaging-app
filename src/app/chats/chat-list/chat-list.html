<ng-template #li let-_chat>
  @let _title = chats.generateTitle(_chat, user());
  <a
    pRipple
    [title]="_title"
    ariaCurrentWhenActive="page"
    routerLinkActive="bg-highlight"
    [routerLink]="['/chats', _chat.id]"
    [routerLinkActiveOptions]="{ exact: true }"
    class="block leading-tight w-full p-2 py-3 border-surface border-b **:align-middle"
  >
    <p-avatar
      label="{{ _title[0]?.toUpperCase() }}"
      class="text-center size-12 me-2"
      shape="circle"
      size="large"
    />
    <span class="inline-block w-[calc(100%-4rem)]">
      <span class="w-full inline-flex justify-between items-center">
        <span
          class="inline-block w-[calc(100%-3rem)] truncate text-lg font-semibold tracking-wider"
        >
          {{ _title || 'Anonymous' }}
        </span>
      </span>
      <br />
      <span class="w-full inline-flex justify-between items-center">
        <span
          class="inline-block w-[calc(100%-3rem)] truncate text-muted-color text-sm font-light tracking-tighter"
        >
          {{ _chat.messages[0]?.body || 'Empty chat!' }}
        </span>
        @if (countNewMessages(_chat); as _newMessagesCount) {
        <p-badge
          [value]="_newMessagesCount < 100 ? _newMessagesCount : '+99'"
          aria-label="New messages"
          class="text-center"
          badgeSize="small"
        />
        }
      </span>
    </span>
  </a>
</ng-template>
<app-list [store]="chats" singularLabel="Chat" pluralLabel="Chats" [itemFragment]="li" />
