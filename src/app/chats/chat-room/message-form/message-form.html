@let _pickingImage = pickingImage();
<form [formGroup]="form" (ngSubmit)="submit()" aria-label="New Message" class="relative">
  <div class="absolute top-0 left-0 w-full h-0 contain-layout">
    @if (_pickingImage) {
    <app-image-picker
      [progress]="progress()"
      (unpicked)="unpickImage()"
      (canceled)="closeImagePicker()"
      (picked)="pickedImage.set($event)"
      class="block absolute left-4 right-4 bottom-full pb-2"
      animate.enter="animate-[slide-down_300ms_ease-in_reverse]"
      animate.leave="animate-[slide-down_300ms_ease-in]"
    />
    }
  </div>
  <div class="bg-(--p-content-background) flex items-end relative p-2">
    <button
      pButton
      pRipple
      rounded
      size="small"
      type="button"
      icon="pi pi-camera"
      severity="secondary"
      [disabled]="form.disabled"
      (click)="toggleImagePicker()"
      aria-label="{{`${_pickingImage ? 'Hide' : 'Show'} image picker`}}"
    ></button>
    <textarea
      #msgInp
      pTextarea
      rows="1"
      pSize="small"
      variant="filled"
      id="message-body"
      [autoResize]="true"
      aria-label="Message"
      formControlName="body"
      placeholder="Message..."
      (onResize)="showScrollbarAsNeeded()"
      [class]="`grow align-middle max-h-[50vh] rounded-2xl mx-2
        text-sm font-semibold tracking-wider placeholder-shown:font-normal`"
    ></textarea>
    <button
      pButton
      pRipple
      rounded
      size="small"
      type="submit"
      aria-label="Send"
      icon="pi pi-send"
      [disabled]="form.disabled"
    ></button>
  </div>
</form>
