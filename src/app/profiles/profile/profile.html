@let _loading = loading();
@let _profile = profile(); @let _currentProfile = profiles.isCurrentProfile(_profile.id);
<section class="size-full overflow-auto flex flex-col">
  <ul class="flex justify-between">
    <li>
      <p-button text rounded outlined type="button" size="small" ariaLabel="Go back"
                [disabled]="_loading" (click)="goBack()" icon="pi pi-arrow-left"></p-button>
    </li>
    @if(_currentProfile) {
    <li>
      <p-button text rounded outlined size="small" type="button" [disabled]="_loading"
                icon="pi pi-ellipsis-v" ariaLabel="Toggle profile options"
                (click)="optionsMenu.toggle($event)"></p-button>
      <p-menu #optionsMenu [model]="optionsMenuItems()" ariaLabel="Profile options menu"
              [popup]="true" />
    </li>
    }
  </ul>
  <div class="max-w-sm m-auto p-4 text-center">
    <app-avatar preview [user]="_profile.user" size="lg" />
    <div class="my-4 **:leading-tight">
      <h2 class="text-xl font-bold">
        {{ _profile.user.fullname }}
      </h2>
      <p class="text-sm text-muted-color font-light">@{{ _profile.user.username }}</p>
      <p class="mt-2 text-muted-color-emphasis tracking-wider">
        {{ _profile.user.bio }}
      </p>
    </div>
    <div class="*:align-middle *:inline-block space-x-2 flex flex-wrap justify-center">
      <p-button rounded type="button" severity="secondary" [disabled]="_loading" icon="pi pi-send"
                ariaLabel="Chat with {{ _currentProfile ? 'yourself' : _profile.user.username }}"
                (click)="selfChat()"></p-button>
      @if (!_currentProfile) {
      @let _followingToggleData = _profile.followedByCurrentUser
      ? { label: 'Unfollow', icon: 'pi pi-user-minus' }
      : { label: 'Follow', icon: 'pi pi-user-plus' };
      <p-button rounded type="button" severity="secondary" [disabled]="_loading"
                [loading]="_loading" [icon]="_followingToggleData.icon"
                ariaLabel="{{_followingToggleData.label}}" (click)="toggleFollowing()"></p-button>
      }
    </div>
  </div>
</section>